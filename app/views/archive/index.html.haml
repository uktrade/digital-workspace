%div{:id => 'category', :class => 'page-content'}
  = render partial: "widgets/people_search_inner_page"
  %main#content.root-index.news-section
    .grid-row
      .column-half
        %ul.breadcrumb
          %li
            = link_to( 'Home', "/" )
          %li
            = link_to( 'News', "/news/" )

      .column-half
        .form-group.select-category
          %label{:class => 'form-label', :for => 'select-category'} Categories
          %select{:class => 'form-control', :id => 'select_category', :name => 'select-category'}
            %option{:value => ""}
              \ Select Category
            - @categories.each do |c|
              %option{:value => "/news/category/" + c["slug"]}
                = link_to( c["name"] )
    .grid-row
      .column-full
        %hr{:class => 'rule-large rule-top'}
        %h2.heading-medium
          All news
    .grid-row
      .column-full

        .hero-news
          .news-item
            -# @posts.each do |p|
            - if @posts.present?
              - @posts[0..0].each_with_index do |p, i|
                .hero-news-copy
                  %h1.heading-small
                    = link_to(p["title"]["rendered"].html_safe, "/news/" + p["slug"])
                  .hero-news-excerpt
                    %p
                      = truncate_excerpt(p["excerpt"]["rendered"])
                    = read_more("/news/" + p["slug"])
                    - if @comments_headers["x-wp-total"].present?
                      - comment_count = Integer(@comments_headers["x-wp-total"])
                      = comments("/news/" + p["slug"], comment_count)

                .hero-news-image-container
                  = large_image_tag(p)

      .column-two-thirds
        - if @posts.present?
          - @posts[1..-1].each_with_index do |p, i|
            .news-item
              %h3.heading-medium
                %hr{:class => 'rule-small'}
                = link_to(p["title"]["rendered"].html_safe, "/news/" + p["slug"])
              .news-item-text
                .news-item-meta
                  - profile = PeopleFinderProfile.from_api(p["author_email"])
                  = succeed ', ' do
                    = profile.name || "Unknown"
                  = succeed ' - ' do
                    - date = DateTime.parse(p["date"])
                    = date.strftime('%d %B %Y')
                    = date.strftime('@ %I:%M')

                  - p["news_category"].each do |cat|
                    = news_cats( cat["name"], cat["slug"] )
                .news-item-excerpt
                  %p
                    = truncate_excerpt(p["excerpt"]["rendered"])
                  = read_more("/news/" + p["slug"])
                  - if @comments_headers["x-wp-total"].present?
                    - comment_count = Integer(@comments_headers["x-wp-total"])
                    = comments("/news/" + p["slug"], comment_count)
              %pre{:style => 'width: 100%; display: block; font-family: Courier New;'}
                = p

          = render partial: "widgets/pagination"

      .column-third.news-category
        %hr{:class => 'rule-large'}
        %h3.heading-small
          All categories

          %ul.list.font-small
            - @categories.each do |c|
              %li
                = link_to( c["name"], "/news/category/" + c["slug"])
                %span.news-category-count.font-xsmall
                  = "(#{c["count"]})"

